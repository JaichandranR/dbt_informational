Generalized Requirements for Dataset Sharing in Trino with Controlled Access
Objective of Dataset Sharing:

A data-sharing process is needed between two teams or organizations, where Team X owns a dataset and intends to share a specific table (table_to_share) with Team Y.
Team Y requires access to this shared table while ensuring secure, controlled access to the data location.
Workflow for Secure Dataset Sharing:

Team X enables register_table access in their Trino instance to share table_to_share with Team Y.
Team X updates their Trino Access Control List (ACL) to allow access to the share_schema schema, enabling the register_table procedure for table_to_share within the specified S3 bucket path.
Cross-Environment Access Configuration:

Team Y must configure their Trino instance to allow access to the share_schema schema in Team X’s data catalog.
Team Y’s IAM role must be updated to include permissions for accessing the specific S3 bucket and path where table_to_share is stored.
Potential Risks:

Unauthorized S3 Path Access: If register_table access is broadly enabled, users may specify any accessible S3 path within the register_table command, risking unauthorized table registrations within the allowed schema.
Controlled Data Registration: To mitigate this, it’s essential to enforce ACL and IAM role restrictions that confine register_table operations to specific, approved S3 paths.
Requirements to Mitigate Risks and Ensure Controlled Access:
Trino ACL Configuration: Restrict register_table access in both Team X and Team Y’s Trino instances to specific schemas (share_schema) and limit access to authorized S3 paths.
IAM Role Management: Ensure Team Y’s IAM role permissions are scoped specifically to the S3 bucket and path containing the shared table (table_to_share).
Prefix-Level S3 Restrictions: Another option to mitigate the risk of unauthorized access is to enable register_table and configure IAM role permissions with prefix-level granularity for S3 access. This restricts access to specific S3 paths where the dataset resides, ensuring that only the designated folder or path is accessible.
Auditing and Monitoring: Implement regular audits to monitor registered tables in Team Y’s share_schema schema, ensuring no unauthorized S3 paths are registered.
Clear Documentation and Approval: Document the shared datasets, approved S3 paths, and maintain an approval process for any changes to the shared data paths.
